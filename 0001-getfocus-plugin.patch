From 1fbb1a111e7784b65a68805cdb2c873b6437ffa5 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Pawe=C5=82=20Marciniak?= <sunwire+git@gmail.com>
Date: Fri, 28 Jan 2022 19:00:15 +0100
Subject: [PATCH 1/2] getfocus plugin use XDG_CONFIG_HOME path when is set

---
 plugins/getfocus.plugin |  2 +-
 plugins/getfocus.py     | 18 +++++++++++-------
 2 files changed, 12 insertions(+), 8 deletions(-)

diff --git a/plugins/getfocus.plugin b/plugins/getfocus.plugin
index bb65ee1a..343ce19b 100644
--- a/plugins/getfocus.plugin
+++ b/plugins/getfocus.plugin
@@ -5,4 +5,4 @@ IAge=2
 Name=Get focus!
 Description=An automatic visual "focus mode" for Liferea, that makes the feedlist less prominent by change its opacity.
 Authors=Paweł Marciniak
-Copyright=Copyright © 2021 Paweł Marciniak
+Copyright=Copyright © 2021-2022 Paweł Marciniak
diff --git a/plugins/getfocus.py b/plugins/getfocus.py
index 479ad3b1..80f544c7 100644
--- a/plugins/getfocus.py
+++ b/plugins/getfocus.py
@@ -1,7 +1,7 @@
 """
 GetFocus! Liferea plugin
 
-Copyright (C) 2021 Paweł Marciniak <sunwire+liferea@gmail.com
+Copyright (C) 2021-2022 Paweł Marciniak <sunwire+liferea@gmail.com
 
 This program is free software: you can redistribute it and/or modify
 it under the terms of the GNU Lesser General Public License as published by
@@ -16,7 +16,8 @@ GNU Lesser General Public License for more details.
 You should have received a copy of the GNU Lesser General Public License
 along with this program.  If not, see <https://www.gnu.org/licenses/>.
 """
-import pathlib
+import os
+from pathlib import Path
 import gettext
 from gi.repository import GObject, Gtk, Liferea, PeasGtk
 
@@ -29,12 +30,15 @@ except FileNotFoundError:
 else:
     _ = t.gettext
 
-file_config = 'opacity.conf'
+FILE_CONFIG = 'opacity.conf'
 
 
 def get_path():
-    return pathlib.Path.joinpath(pathlib.Path.home(),
-                                 ".config/liferea/plugins/getfocus")
+    config_path = "liferea/plugins/getfocus"
+    config_home = os.getenv('XDG_CONFIG_HOME')
+    if config_home:
+        return Path.joinpath(Path(config_home), config_path)
+    return Path.joinpath(Path.home(), ".config", config_path)
 
 
 class GetFocusPlugin(GObject.Object, Liferea.ShellActivatable):
@@ -69,7 +73,7 @@ class GetFocusPlugin(GObject.Object, Liferea.ShellActivatable):
 
     def read_opacity_from_file(self):
         path = get_path()
-        file_path = path / file_config
+        file_path = path / FILE_CONFIG
         if file_path.exists():
             self.opacity = float(file_path.read_text())
 
@@ -125,5 +129,5 @@ class GetFocusConfigure(GObject.Object, PeasGtk.Configurable):
     def save_opacity_to_file(self, widget):
         path = get_path()
         path.mkdir(0o700, True, True)
-        file_path = path / file_config
+        file_path = path / FILE_CONFIG
         file_path.write_text(str(self.opacity))
-- 
2.35.1


From 1710e6257d95af8bb4bbb62c52922459341734dd Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Pawe=C5=82=20Marciniak?= <sunwire+git@gmail.com>
Date: Sat, 29 Jan 2022 08:11:12 +0100
Subject: [PATCH 2/2] simplify the get_path code

---
 plugins/getfocus.py | 6 ++----
 1 file changed, 2 insertions(+), 4 deletions(-)

diff --git a/plugins/getfocus.py b/plugins/getfocus.py
index 80f544c7..6c63ff65 100644
--- a/plugins/getfocus.py
+++ b/plugins/getfocus.py
@@ -35,10 +35,8 @@ FILE_CONFIG = 'opacity.conf'
 
 def get_path():
     config_path = "liferea/plugins/getfocus"
-    config_home = os.getenv('XDG_CONFIG_HOME')
-    if config_home:
-        return Path.joinpath(Path(config_home), config_path)
-    return Path.joinpath(Path.home(), ".config", config_path)
+    config_home = os.getenv('XDG_CONFIG_HOME',Path.joinpath(Path.home(), ".config"))
+    return Path.joinpath(Path(config_home), config_path)
 
 
 class GetFocusPlugin(GObject.Object, Liferea.ShellActivatable):
-- 
2.35.1

